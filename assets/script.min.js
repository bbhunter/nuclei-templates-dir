const repo="projectdiscovery/nuclei-templates";var blob=`https://github.com/${repo}/blob/`,cmd=document.getElementById("command"),cmdDialog=document.getElementById("command-dialog"),cmdTitle=document.getElementById("command-title"),cmdURL=document.getElementById("command-url");function init(){var e=window.localStorage.getItem("db");null==e?getDb():(window.db=JSON.parse(e),(e=new XMLHttpRequest).open("GET","/VERSION",!0),e.send(),e.addEventListener("readystatechange",function(){this.readyState===this.DONE&&200===this.status&&(this.response.trim()!==window.db.version?getDb:toggle)()})),blob+=window.db.version,loadTop10()}function toggle(e){e?(dialogMsg.innerText="Database can't be loaded: "+e.toString(),dialog.showModal()):(version.innerText=window.db.version,versionBadge.removeAttribute("style"),cveYear.innerText="cve-"+(new Date).getFullYear(),suggest.style.display="block",search.removeAttribute("disabled"),getQueryHash())}function getDb(){var e=new XMLHttpRequest;e.open("GET","db.json.gz",!0),e.responseType="arraybuffer",e.send(),e.addEventListener("readystatechange",function(){if(this.readyState===this.DONE)try{var e=pako.inflate(this.response,{to:"string"});window.db=JSON.parse(e),window.localStorage.setItem("db",e),toggle()}catch(e){toggle(e)}})}function loadTop10(){var e=new XMLHttpRequest;e.open("GET",`https://raw.githubusercontent.com/${repo}/main/TOP-10.md`,!0),e.send(),e.addEventListener("readystatechange",function(){var e,t;this.readyState===this.DONE&&200===this.status&&(e=Array.from(this.response.matchAll(/^\|\s\w+.+?\|\s+\d+\s\|\s(\w+)/gm)).map(e=>e[1]),t="",e.forEach(function(e){t+=`<a class="contributor" href="https://github.com/${e}" target="_blank">`+`<img class="nes-avatar is-large is-rounded lazy" src="//github.com/${e}.png?size=64" onerror="this.onerror=null, this.src='//github.com/github.png?size=64'">`+`<p>${e}</p></a>
`}),top10.innerHTML=t,contributors.style.display="block")})}function genCommand(e){var t="$ nuclei -u ",s=e.getAttribute("href").replace(blob+"/","");return s.startsWith("file/")?t+=`"DIRECTORY" -t "${s}"`:s.startsWith("workflows/")?t+=`"URL" -w "${s}"`:s.startsWith("headless/")?t+=`"URL" -t "${s}" -headless`:s.startsWith("dns/")||s.startsWith("network/")?t+=`"HOST" -t "${s}"`:t+=`"URL" -t "${s}"`,cmd.innerText=t,hljs.highlightAll(),cmdTitle.innerText=e.innerText,cmdURL.setAttribute("href",blob+"/"+s),remoteURL.checked=!1,cmdDialog.showModal(),!1}function getQueryHash(){var e=location.hash.substr(1).split("&"),t="";e.forEach(function(e){e=e.split("=");"q"==e[0]&&(t=decodeURIComponent(e[1]))}),""!==t&&doSuggest(t)}function doSuggest(e){let t="";switch(typeof e){case"object":t=e.innerText;break;case"string":t=e}search.value=t,doSearch()}function replaceState(e){e=window.location.pathname+(""!=e?"#q="+e:"");window.history.replaceState(null,window.document.title,e)}function getIcon(e,t,s){("number"!=typeof s||s<1)&&(s=16);let r="",a="#";switch(t){case"open":a+="42a0ff",r="pull_request"==e?'<path d="M7.177 3.073L9.573.677A.25.25 0 0110 .854v4.792a.25.25 0 01-.427.177L7.177 3.427a.25.25 0 010-.354zM3.75 2.5a.75.75 0 100 1.5.75.75 0 000-1.5zm-2.25.75a2.25 2.25 0 113 2.122v5.256a2.251 2.251 0 11-1.5 0V5.372A2.25 2.25 0 011.5 3.25zM11 2.5h-1V4h1a1 1 0 011 1v5.628a2.251 2.251 0 101.5 0V5A2.5 2.5 0 0011 2.5zm1 10.25a.75.75 0 111.5 0 .75.75 0 01-1.5 0zM3.75 12a.75.75 0 100 1.5.75.75 0 000-1.5z"></path>':"issue"==e&&'<path d="M8 9.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"></path><path d="M8 0a8 8 0 100 16A8 8 0 008 0zM1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0z"></path>';break;case"closed":a+="a371f7",r="pull_request"==e?'<path d="M5 3.254V3.25v.005a.75.75 0 110-.005v.004zm.45 1.9a2.25 2.25 0 10-1.95.218v5.256a2.25 2.25 0 101.5 0V7.123A5.735 5.735 0 009.25 9h1.378a2.251 2.251 0 100-1.5H9.25a4.25 4.25 0 01-3.8-2.346zM12.75 9a.75.75 0 100-1.5.75.75 0 000 1.5zm-8.5 4.5a.75.75 0 100-1.5.75.75 0 000 1.5z"></path>':"issue"==e&&'<path d="M11.28 6.78a.75.75 0 00-1.06-1.06L7.25 8.69 5.78 7.22a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l3.5-3.5z"></path><path d="M16 8A8 8 0 110 8a8 8 0 0116 0zm-1.5 0a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z"></path>'}return`<svg style="fill: ${a}" viewBox="0 0 ${s} ${s}" version="1.1" width="${s}" height="${s}" aria-hidden="true">`+r+"</svg>"}function doSearch(){var e=search.value.trim(),t=new RegExp(e.escapeRegExp(),"i"),s=[],r="";if(replaceState(e),""===e)result.style.display="none",search.classList.remove("is-error");else{for(var a=window.db.data,n=0;n<a.length;n++){var o=a[n];-1==o.author.toString().search(t)&&-1==o.id.search(t)&&-1==o.name.search(t)&&-1==o.tags.search(t)||s.push(o);try{!jmespath.search(o,e)||o in s||s.push(o)}catch(o){console.error(o);break}}0<s.length?(s.forEach(function(e){var t=(e.id.startsWith("CVE")?e.id+": ":"")+e.name,s=""==e.severity?"none":e.severity.toLowerCase();r+='<li><div class="severity-indicator"><div class="severity-indicator_separator"></div><div class="severity-indicator_separator"></div><div class="severity-indicator_separator"></div><div class="severity-indicator_separator"></div>'+`<div class="severity-indicator_progress severity-indicator_progress-${s}"></div></div> `+`<a href="${blob}/${e.path}" onclick="return genCommand(this);">${t}</a></li>`}),shrug.style.display="none",search.classList.remove("is-error")):(shrug.style.display="block",search.classList.add("is-error")),count.innerText=s.length,keyword.innerText=e,list.innerHTML=r,result.style.display="block"}}function doSearchIssue(){var e,t=searchIssue.value.trim(),s=0,r=res="";""===t?resultIssue.style.display="none":t!=historySearchIssue&&((e=new XMLHttpRequest).open("GET",`https://api.github.com/search/issues?q=${encodeURIComponent(t)}+repo:${repo}+in:title&sort=created&order=desc&per_page=100`,!0),e.setRequestHeader("Accept","application/vnd.github.v3.text-match+json"),e.send(),e.onreadystatechange=function(){this.readyState===this.DONE&&(res=JSON.parse(this.response),200==this.status?(s=res.total_count,res.items.forEach(function(e){type="object"==typeof e.pull_request?"pull_request":"issue",r+=`<li>${getIcon(type,e.state)} <a href="https://github.com/${repo}/${"pull_request"==type?"pull":"issue"==type&&type+"s"}/${e.number}" target="_blank">${e.title}</a></li>`}),100<res.total_count&&(r+=`<br><p class="nes-text is-error">* The display limit is 100, for the rest navigate to the <a href="https://github.com/${repo}/issues?q=${encodeURIComponent(t)}" target="_blank">GitHub repository page</a>.</p>`),0==s?(shrugIssue.style.display="block",searchIssue.classList.add("is-error")):(shrugIssue.style.display="none",searchIssue.classList.remove("is-error"))):403==this.status?(rateLimited.style.display="block",shrugIssue.style.display="none",searchIssue.classList.add("is-error")):(rateLimited.style.display="none",searchIssue.classList.remove("is-error")),countIssue.innerText=s,keywordIssue.innerText=t,listIssue.innerHTML=r,resultIssue.style.display="block")},historySearchIssue=t)}contributors=document.getElementById("contributors"),count=document.getElementById("count"),countIssue=document.getElementById("count-issue"),cveYear=document.getElementById("cve-year-suggest"),dialog=document.getElementById("dialog"),dialogMsg=document.getElementById("dialog-message"),header=document.getElementById("header"),historySearchIssue="",keyword=document.getElementById("keyword"),keywordIssue=document.getElementById("keyword-issue"),list=document.getElementById("list"),listIssue=document.getElementById("list-issue"),octocat=document.getElementsByClassName("github-link")[0],rateLimited=document.getElementById("rate-limited-issue"),result=document.getElementById("result"),resultIssue=document.getElementById("result-issue"),search=document.getElementById("search"),searchIssue=document.getElementById("search-issue"),shrug=document.getElementById("shrug"),shrugIssue=document.getElementById("shrug-issue"),suggest=document.getElementById("suggest"),top10=document.getElementById("top-10"),version=document.getElementById("version"),remoteURL=document.getElementById("remote-url"),versionBadge=document.getElementById("version-badge"),String.prototype.toHtmlEntities=function(){return this.replace(/./gm,function(e){return e.match(/[a-z0-9\s-_]+/i)?e:"&#"+e.charCodeAt(0)+";"})},String.prototype.escapeRegExp=function(){return this.replace(/./gm,function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")})},remoteURL.addEventListener("change",e=>{var t=cmdURL.getAttribute("href").replace(blob+"/",""),s=blob.replace("/blob/","/raw/")+"/"+t;e.target.checked?cmd.innerText=cmd.innerText.replace(t,s):cmd.innerText=cmd.innerText.replace(s,t),hljs.highlightAll()}),document.body.onscroll=function(){50<window.pageYOffset?(header.setAttribute("class","sticky"),octocat.classList.remove("active")):(header.removeAttribute("class"),octocat.classList.add("active"))},search.addEventListener("keyup",doSearch),searchIssue.addEventListener("keyup",doSearchIssue);